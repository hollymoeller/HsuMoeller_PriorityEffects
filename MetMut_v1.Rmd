---
title: "MetMut_v1"
author: "Veronica Hsu and Holly V. Moeller"
date: "9/2/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

##Introduction
1) Priority effects metrics. 
2) Time series graphs. 
3) Max population and growth rate comparisons. 

```{r}
library(readr)
df_og <- read_csv(("MetMut.csv"), 
  col_types = cols(
    Treatment = col_character(),
    Species = col_character(),
    Light_Level = col_character(),
    Replicate = col_character(), 
    Experimental_Day = col_double(),
    Cells = col_double(),
    Growth_Rate = col_double(),
    P_values = col_double()
  )
)
```

```{r}
library(readr)
library(dplyr)
library(tidyr)
library(forcats)
library("ggpubr")
library("cowplot")
library(scales)
library("gridExtra")
library(Rmisc)
library(dplyr)
library(ggplot2)

```

##1) Priority Effects Metric

Conduct a Tukey Test to see if the P-values are significantly different from 0. 
```{r}
df1 <- na.omit(df_og) #omit rows of data without any values
p_c <- df1 %>% filter(`Species` == "Colp")
p_p <- df1 %>% filter(`Species` == "P bur")

# Compute the analysis of variance
res.aov_c <- aov(`P_values` ~ `Light_Level`, data = p_c)
res.aov_p <- aov(`P_values` ~ `Light_Level`, data = p_p)
res.aov <- aov(`P_values` ~ `Light_Level`*`Treatment`, data = df1)

# Summary of the analysis
summary(res.aov_c)
summary(res.aov_p)
summary(res.aov)

TukeyHSD(res.aov_p)
TukeyHSD(res.aov_c)
TukeyHSD(res.aov)
```
Make boxplots of the P-values. 
```{r}
##Boxplot, and conduct one-sample wilcoxon test to test signif from 0
df.colp <- df1 %>% filter(Species == "Colp")
df.pbur <- df1 %>% filter(Species == "P bur")

df.colp.1 <- df1 %>% filter(Species == "Colp", Light_Level == "0")
df.colp.2 <- df1 %>% filter(Species == "Colp", Light_Level == "50")
df.colp.3 <- df1 %>% filter(Species == "Colp", Light_Level == "100")
df.colp.4 <- df1 %>% filter(Species == "Colp", Light_Level == "200")
df.pbur.1 <- df1 %>% filter(Species == "P bur", Light_Level == "0")
df.pbur.2 <- df1 %>% filter(Species == "P bur", Light_Level == "50")
df.pbur.3 <- df1 %>% filter(Species == "P bur", Light_Level == "100")
df.pbur.4 <- df1 %>% filter(Species == "P bur", Light_Level == "200")

t.colp <- t.test(df.colp$`P_values`, mu=0) #t-test for colpidium
colp.1 <- t.test(df.colp.1$`P_values`, mu=0)
colp.2 <- t.test(df.colp.2$`P_values`, mu=0)
colp.3 <- t.test(df.colp.3$`P_values`, mu=0)
colp.4 <- t.test(df.colp.4$`P_values`, mu=0)

t.pbur <- t.test(df.pbur$`P_values`, mu=0)#t-test for pbur
pbur.1 <- t.test(df.pbur.1$`P_values`, mu=0)
pbur.2 <- t.test(df.pbur.2$`P_values`, mu=0)
pbur.3 <- t.test(df.pbur.3$`P_values`, mu=0)
pbur.4 <- t.test(df.pbur.4$`P_values`, mu=0)

colp.1$p.value
colp.2$p.value
colp.3$p.value
colp.4$p.value
pbur.1$p.value
pbur.2$p.value
pbur.3$p.value
pbur.4$p.value
t.colp$p.value
t.pbur$p.value
```

```{r}
y=10 # plot title size
t=8 # 
l=10 #legend text size
greyscale=c('black', "#666666", "#999999","#CCCCCC")
coral = c('coral4', 'coral3', 'coral1', 'coral')
indianred = c('indianred4','indianred3','indianred2','indianred1')
salmon = c('lightsalmon4','lightsalmon3','lightsalmon1','peachpuff')
customc = c('coral4','coral1','peachpuff','papayawhip')
green = c('darkgreen','olivedrab','yellowgreen','darkolivegreen2')
pccolors=c('lightsalmon1','olivedrab')
lightcolors=c('darkgreen', 'coral4')
pcolors=green
ccolors=salmon

```

```{r}

labels.up <- c("a","a", "b",NA,"b",NA,"a",NA)
labels_sup <- c("*", NA, "**", NA, "***", NA, NA, NA)
labels.down <- c(NA,NA, NA,"c",NA,"c",NA,"c")
labels_sdown <- c(NA, NA,NA, "**", NA, "**", NA, "**")
df.ana <- summarySE(df1, measurevar="P_values", groupvars=c("Light_Level", "Species"))
df.ana$`Light_Level` = factor(df.ana$`Light_Level`, labels = c("0μE", "100μE", "200μE", "50μE"))
df.ana= mutate(df.ana, `Light_Level`=fct_relevel(`Light_Level`,"0μE","50μE", "100μE", "200μE"))

Pv2 <- ggplot(df.ana, aes(x = Species, y = `P_values`, fill=Light_Level))+
  geom_col(position="dodge")+
  scale_fill_manual(values=greyscale)+
  geom_errorbar(aes(ymin=`P_values`-se, ymax=`P_values`+se),
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9), color='black') + #add axis and title names
  theme_bw()+
  theme(legend.text=element_text(size=12, face='italic'),
        legend.key.size = unit(0.7, 'lines'),
        legend.background=element_rect(colour=NA, fill=NA),
        legend.position = c(0.13, 0.1),
        legend.title= element_blank(),
        legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
        legend.margin=margin(c(-5,1,1,1)),
        axis.line = element_blank(),
        # panel.grid.major = element_blank(),
        # panel.grid.minor = element_blank(),
        panel.border = element_rect(colour="grey"),
        plot.tag.position = c(0.01,0.97),
        plot.tag = element_text(size=15),
        plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
        axis.ticks.x = element_blank(),
        axis.text.y = element_text(size = 10),
        axis.text.x = element_text(size = 12),
        axis.title = element_blank())+
  scale_y_continuous(limits = c(-2.31,1.6))+
  scale_x_discrete(labels=c("Colpidium", "P. bursaria"))+
  labs(tag ='B') +
  geom_text(aes(label = labels.up, y = `P_values`+se), position = position_dodge(0.9), vjust = -.3, size=4)+
  geom_text(aes(label = labels.down, y = `P_values`- se-.17), position = position_dodge(0.9), vjust = -.3, size=4)+
  geom_text(aes(label = labels_sup, y = `P_values`+se+.05), position = position_dodge(0.9), vjust = -.3, size=6)+
  geom_text(aes(label = labels_sdown, y = `P_values`-se-.41), position = position_dodge(0.9), vjust = -.3, size=6)



Pv1 <- ggplot(df1, aes(x=Species, y=`P_values`)) +
  geom_boxplot(aes(Species, color=Species), position="dodge", alpha=0.2, width=0.2) +
  geom_jitter(shape=16, position=position_jitter(0.05), size = 2, aes(colour=Species)) +
  scale_colour_manual(values=pccolors)+
  annotate("text", x = c(1.02,2.02), y = c(min(df.colp$`P_values`)-0.5, max(df.pbur$`P_values`)+0.5), label = c("**","***"), size=8)+
  theme_bw()+
  theme(plot.tag.position = c(0.01,0.97),
    panel.border = element_rect(colour="grey"),
    plot.tag = element_text(size=15),
    legend.position=("none"), 
    axis.title = element_blank(), 
    axis.ticks.x = element_blank(),
    axis.text.y = element_text(size = 10),
    axis.text.x = element_text(size = 12)) +
  scale_y_continuous(limits = c(-2.31,1.6))+
  scale_x_discrete(labels=c("Colpidium", "P. bursaria")) +
  labs(tag="A")

p_value<- ggdraw() +
  draw_plot(Pv1, 0, 0, .5, .9) +
  draw_plot(Pv2, .5, 0, .5, .9)

annotate_figure(p_value,
                left = text_grob("Priority Effects ", size=15, rot = 90))
```


##2) Time Series Graphs
```{r}
#Create new data frames for each treatment and light level, 20 plots
library(dplyr)
library(ggplot2)
library(Rmisc)
library("gridExtra")
library("cowplot")
library(forcats)
df <- df_og

df= mutate(df, Species=fct_relevel(Species,"P bur","Colp"))

df.fig4_1 <- df %>% filter(Light_Level == "0", Treatment=="CP") #CP 0μE 
df.fig4_2 <- df %>% filter(Light_Level == "50", Treatment=="CP")
df.fig4_3 <- df %>% filter(Light_Level == "100", Treatment=="CP")
df.fig4_4 <- df %>% filter(Light_Level == "200", Treatment=="CP")

df.fig5_1 <- df %>% filter(Light_Level == "0", Treatment=="PC") #PC 0μE 
df.fig5_2 <- df %>% filter(Light_Level == "50", Treatment=="PC")
df.fig5_3 <- df %>% filter(Light_Level == "100", Treatment=="PC")
df.fig5_4 <- df %>% filter(Light_Level == "200", Treatment=="PC")


#Create df for summary SE

df.fig4_1_ana <- summarySE(df.fig4_1, measurevar="Cells", groupvars=c("Species","Experimental_Day")) #CP
df.fig4_2_ana <- summarySE(df.fig4_2, measurevar="Cells", groupvars=c("Species","Experimental_Day")) 
df.fig4_3_ana <- summarySE(df.fig4_3, measurevar="Cells", groupvars=c("Species","Experimental_Day"))
df.fig4_4_ana <- summarySE(df.fig4_4, measurevar="Cells", groupvars=c("Species","Experimental_Day"))

df.fig5_1_ana <- summarySE(df.fig5_1, measurevar="Cells", groupvars=c("Species","Experimental_Day")) #PC
df.fig5_2_ana <- summarySE(df.fig5_2, measurevar="Cells", groupvars=c("Species","Experimental_Day")) 
df.fig5_3_ana <- summarySE(df.fig5_3, measurevar="Cells", groupvars=c("Species","Experimental_Day"))
df.fig5_4_ana <- summarySE(df.fig5_4, measurevar="Cells", groupvars=c("Species","Experimental_Day"))
```


Population dynamics of priority effect experiments, both P. bur-first and Colp-first treatments. 
```{r}
title=c(10,-1,-1,10) #title position for panels
legend=c(0.7,0.3)
limx=c(0,40)
limy=c(1,7500) #limits of y axis
lines2 = c("solid", "solid")
colors2 = c('black','gray') # CP treatments
colors3 = c('black','gray') # PE treatments 


p.fig4_1<- ggplot(df.fig4_1, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(color="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.x=element_blank(), #x axis blank
    axis.title.y=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title),hjust=(0.5)),
    legend.position=("none"))+ 
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig4_1_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors2)+
  geom_line(data = df.fig4_1_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig4_1_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "0μE",
       x="Time (days)",
       y="Cells",
       tag="A")


p.fig4_2<- ggplot(df.fig4_2, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #take out x and y axes
    axis.title.x=element_blank(),
    axis.title=element_text(size=x),
    axis.ticks = element_blank(),
    legend.text=element_text(size=l, face='italic'),
    legend.key.size = unit(0.7, 'lines'),
    legend.background=element_rect(colour=NA, fill=NA),
    legend.position = c(0.36,0.12),
    legend.title=element_blank(),
    legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
    legend.margin=margin(c(-5,1,1,1)),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title),hjust=(0.5))) +
  scale_x_discrete(limit=c('Colp', 'P bur'))+
 scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)), 
                    expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig4_2_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2,breaks=c('P bur', 'Colp'), labels=c('P. bursaria', 'Colpidium'))+
  scale_color_manual(values=colors2,breaks=c('P bur', 'Colp'), labels=c('P. bursaria', 'Colpidium'))+
  guides(color = guide_legend(reverse=TRUE), linetype = guide_legend(reverse=TRUE))+
  geom_line(data = df.fig4_2_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig4_2_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "50μE",
       x="Time (days)",
       y="Cells",
       tag="B")

p.fig4_3<- ggplot(df.fig4_3, aes(x=Experimental_Day, y=Cells, group= Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(color="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    legend.title=element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig4_3_ana, position=pd, aes(color=Species)) + #now overlay the graph using analysis data frame with the averages
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors2)+
  geom_line(data = df.fig4_3_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig4_3_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "100μE",
       x="Time (days)",
       y="Cells",
       tag="C")

p.fig4_4<- ggplot(df.fig4_4, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig4_4_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors2)+
  geom_line(data = df.fig4_4_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig4_4_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "200μE",
       x="Time (days)",
       y="Cells",
       tag ='D')


p.fig5_1<- ggplot(df.fig5_1, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(color="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.x=element_blank(), #x axis blank
    axis.title.y=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title),hjust=(0.5)),
    legend.position=("none"))+ 
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig5_1_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors3)+
  geom_line(data = df.fig5_1_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig5_1_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "0μE",
       x="Time (days)",
       y="Cells",
       tag="E")

p.fig5_2<- ggplot(df.fig5_2, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #take out x and y axes
    axis.title.x=element_blank(),
    axis.title=element_text(size=x),
    axis.ticks = element_blank(),
    legend.text=element_text(size=l, face='italic'),
    legend.key.size = unit(0.7, 'lines'),
    legend.background=element_rect(colour=NA, fill=NA),
    legend.position = c(0.36,0.12),
    legend.title=element_blank(),
    legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
    legend.margin=margin(c(-5,1,1,1)),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title),hjust=(0.5))) +
  scale_x_discrete(limit=c('Colp', 'P bur'))+
 scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)), 
                    expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig5_2_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2,breaks=c('P bur', 'Colp'), labels=c('P. bursaria', 'Colpidium'))+
  scale_color_manual(values=colors3,breaks=c('P bur', 'Colp'), labels=c('P. bursaria', 'Colpidium'))+
  guides(color = guide_legend(reverse=TRUE), linetype = guide_legend(reverse=TRUE))+
  geom_line(data = df.fig5_2_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig5_2_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "50μE",
       x="Time (days)",
       y="Cells",
       tag="F")

p.fig5_3<- ggplot(df.fig5_3, aes(x=Experimental_Day, y=Cells, group= Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(color="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    legend.title=element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig5_3_ana, position=pd, aes(color=Species)) + #now overlay the graph using analysis data frame with the averages
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors3)+
  geom_line(data = df.fig5_3_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig5_3_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "100μE",
       x="Time (days)",
       y="Cells",
       tag="G")

p.fig5_4<- ggplot(df.fig5_4, aes(x=Experimental_Day, y=Cells, group=Species)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.fig5_4_ana, position=pd, aes(color=Species)) + #now overlay the graph
  scale_linetype_manual(values=lines2)+
  scale_color_manual(values=colors3)+
  geom_line(data = df.fig5_4_ana, position=pd, aes(linetype=Species, color=Species)) +
  geom_errorbar(data = df.fig5_4_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Species)) +
  labs(title = "200μE",
       x="Time (days)",
       y="Cells",
       tag ='H')

p.fig1<- ggdraw() +
  draw_plot(p.fig5_1, 0, 0, .25, .5) +
  draw_plot(p.fig5_3, .5, 0, .25, .5) +
  draw_plot(p.fig5_4, .75, 0, .25, .5) +
  draw_plot(p.fig5_2, .25, 0, .25, .5) +
  draw_plot(p.fig4_1, 0, .5, .25, .5) +
  draw_plot(p.fig4_3, .5, .5, .25, .5) +
  draw_plot(p.fig4_4, .75, .5, .25, .5) +
  draw_plot(p.fig4_2, .25, .5, .25, .5)
  # draw_plot_label(label = c("P. bursaria", "Colpidium"), size = y, x=c(0,0), y=c(1,0.5))
 
annotate_figure(p.fig1,
                bottom = text_grob("Time (days)", size=x), 
                left = text_grob("Population (cells/mL)", size=x, rot = 90)) 
```

```{r}
limy=c(1,7000) #limits of y axis
lines = c("dotted", "solid", "solid")
shapes = c(0, 19, 19)
colorsp = c("gray", "darkgreen", "yellowgreen")
colorsc = c("gray", "lightsalmon4", "lightsalmon1")

df <- df_og
df$Experimental_Day <- ifelse (df$Species == 'P bur' & df$Treatment == 'CP', df$Experimental_Day -6, df$Experimental_Day) #use ifelse statement to change experimental day to D0 for P bur CP
df$`Experimental_Day` <- ifelse (df$Species == 'Colp' & df$Treatment == 'PC', df$Experimental_Day -14, df$Experimental_Day) #use ifelse statement to change experimental day to D0 for Colp PC

df.S3P_1 <- df %>% filter(Species == "P bur", Light_Level=="0") #P bur
df.S3P_1= mutate(df.S3P_1, Treatment=fct_relevel(Treatment,"P bur","Comp", "CP", "PC"))
df.S3P_2 <- df %>% filter(Species == "P bur", Light_Level=="50")
df.S3P_2= mutate(df.S3P_2, Treatment=fct_relevel(Treatment,"P bur","Comp", "CP", "PC"))
df.S3P_3 <- df %>% filter(Species == "P bur", Light_Level=="100")
df.S3P_3= mutate(df.S3P_3, Treatment=fct_relevel(Treatment,"P bur","Comp", "CP", "PC"))
df.S3P_4 <- df %>% filter(Species == "P bur", Light_Level=="200")
df.S3P_4= mutate(df.S3P_4, Treatment=fct_relevel(Treatment,"P bur","Comp", "CP", "PC"))

df.S3C_1 <- df %>% filter(Species == "Colp", Light_Level=="0") #Colp
df.S3C_2 <- df %>% filter(Species == "Colp", Light_Level=="50")
df.S3C_3 <- df %>% filter(Species == "Colp", Light_Level=="100")
df.S3C_4 <- df %>% filter(Species == "Colp",Light_Level=="200")

df.S3P_1 <- df.S3P_1 %>% filter(Treatment %in% c("P bur", "CP", "PC"))
df.S3P_2 <- df.S3P_2 %>% filter(Treatment %in% c("P bur", "CP", "PC"))
df.S3P_3 <- df.S3P_3 %>% filter(Treatment %in% c("P bur", "CP", "PC"))
df.S3P_4 <- df.S3P_4 %>% filter(Treatment %in% c("P bur", "CP", "PC"))

df.S3C_1 <- df.S3C_1 %>% filter(Treatment %in% c("Colp", "CP", "PC"))
df.S3C_2 <- df.S3C_2 %>% filter(Treatment %in% c("Colp", "CP", "PC"))
df.S3C_3 <- df.S3C_3 %>% filter(Treatment %in% c("Colp", "CP", "PC"))
df.S3C_4 <- df.S3C_4 %>% filter(Treatment %in% c("Colp", "CP", "PC"))

#Create df for summary SE
df.S3P_1_ana <- summarySE(df.S3P_1, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment")) #P bur
df.S3P_2_ana <- summarySE(df.S3P_2, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment")) 
df.S3P_3_ana <- summarySE(df.S3P_3, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment"))
df.S3P_4_ana <- summarySE(df.S3P_4, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment"))

df.S3C_1_ana <- summarySE(df.S3C_1, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment")) #Colp
df.S3C_2_ana <- summarySE(df.S3C_2, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment")) 
df.S3C_3_ana <- summarySE(df.S3C_3, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment"))
df.S3C_4_ana <- summarySE(df.S3C_4, measurevar="Cells", groupvars=c("Experimental_Day", "Treatment"))

p.S3P_1<- ggplot(df.S3P_1, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    legend.position="none",
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)))+
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3P_1_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsp)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3P_1_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3P_1_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "0μE",
       x="Time (days)",
       y="Cells",
       tag ='A')

p.S3P_2<- ggplot(df.S3P_2, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.text=element_text(size=l, face='italic'),
    legend.key.size = unit(0.7, 'lines'),
    legend.background=element_rect(colour=NA, fill=NA),
    legend.position = c(0.33,0.17),
    legend.title=element_blank(),
    legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
    legend.margin=margin(c(-5,1,1,1)))+
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3P_2_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines, breaks=c('P bur', 'CP', 'PC'), labels=c('Control', 'Colp first', 'P bur first'))+
  scale_color_manual(values=colorsp, breaks=c('P bur', 'CP','PC'), labels=c('Control', 'Colp first','P bur first'))+
  scale_shape_manual(values=shapes, breaks=c('P bur', 'CP', 'PC'), labels=c('Control', 'Colp first', 'P bur first'))+
  geom_line(data = df.S3P_2_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3P_2_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "50μE",
       x="Time (days)",
       y="Cells",
       tag ='B')

p.S3P_3<- ggplot(df.S3P_3, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3P_3_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsp)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3P_3_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3P_3_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "100μE",
       x="Time (days)",
       y="Cells",
       tag ='C')

p.S3P_4<- ggplot(df.S3P_4, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3P_4_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsp)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3P_4_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3P_4_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "200μE",
       x="Time (days)",
       y="Cells",
       tag ='D')

p.S3C_1<- ggplot(df.S3C_1, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    legend.position="none",
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)))+
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3C_1_ana, position=pd, aes(color=Treatment,shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsc)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3C_1_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3C_1_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "0μE",
       x="Time (days)",
       y="Cells",
       tag ='E')

p.S3C_2<- ggplot(df.S3C_2, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.text=element_text(size=l, face='italic'),
    legend.key.size = unit(0.7, 'lines'),
    legend.background=element_rect(colour=NA, fill=NA),
    legend.position = c(0.33,0.17),
    legend.title=element_blank(),
    legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
    legend.margin=margin(c(-5,1,1,1)))+
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3C_2_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines, breaks=c('Colp', 'CP', 'PC'), labels=c('Control', 'Colp first', 'P bur first'))+
  scale_color_manual(values=colorsc, breaks=c('Colp', 'CP','PC'), labels=c('Control', 'Colp first','P bur first'))+
  scale_shape_manual(values=shapes, breaks=c('Colp', 'CP', 'PC'), labels=c('Control', 'Colp first', 'P bur first'))+
  geom_line(data = df.S3C_2_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3C_2_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "50μE",
       x="Time (days)",
       y="Cells",
       tag ='F')

p.S3C_3<- ggplot(df.S3C_3, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3C_3_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsc)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3C_3_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3C_3_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "100μE",
       x="Time (days)",
       y="Cells",
       tag ='G')

p.S3C_4<- ggplot(df.S3C_4, aes(x=Experimental_Day, y=Cells, group=Treatment)) +
  theme_bw()+
  theme(axis.line = element_blank(),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.border = element_rect(colour="grey"),
    panel.background = element_blank(),
    axis.text=element_text(size=t),
    axis.title.y=element_blank(), #x axis blank
    axis.title=element_blank(),
    axis.ticks = element_blank(),
    plot.tag.position = c(0.05,0.85),
    plot.tag = element_text(size=12),
    plot.title = element_text(size=y, margin = margin(title), hjust = (0.5)),
    legend.position=("none"))+ #take out legend for now
  scale_y_continuous(trans=log10_trans(), 
                     limits=limy, 
                     breaks= trans_breaks("log10", function(x) 10^x),
                     labels = trans_format("log10", math_format(10^.x)),
                     expand = c(0, 0)) + 
  scale_x_continuous(limits=limx, breaks=c(0, 20, 40), labels = c(0, 20, 40), expand = c(0, 0)) +
  geom_point (data = df.S3C_4_ana, position=pd, aes(color=Treatment, shape=Treatment)) + #now overlay the graph
  scale_linetype_manual(values=lines)+
  scale_color_manual(values=colorsc)+
  scale_shape_manual(values=shapes)+
  geom_line(data = df.S3C_4_ana, position=pd, aes(linetype=Treatment, color=Treatment)) +
  geom_errorbar(data = df.S3C_4_ana, aes(ymin=Cells-se, ymax=Cells+se, color=Treatment)) +
  labs(title = "200μE",
       x="Time (days)",
       y="Cells",
       tag ='H')

p.S3<- ggdraw() +
  draw_plot(p.S3C_1, 0, 0, .25, .5) +
  draw_plot(p.S3C_3, .5, 0, .25, .5) +
  draw_plot(p.S3C_4, .75, 0, .25, .5) +
  draw_plot(p.S3C_2, .25, 0, .25, .5) +
  draw_plot(p.S3P_1, 0, .53, .25, .5) +
  draw_plot(p.S3P_3, .5, .53, .25, .5) +
  draw_plot(p.S3P_4, .75, .53, .25, .5) +
  draw_plot(p.S3P_2, .25, .53, .25, .5) 
  # draw_plot_label(label = c("P. bursaria", "Colpidium"), size = y, x=c(0,0), y=c(1,0.5))

 
annotate_figure(p.S3,
                bottom = text_grob("Time (days)", size=x), 
                left = text_grob("Population (cells/mL)", size=x, rot = 90)) 
```


##3) Max pop and growth rate comparisons for single-cell and priority effect treatments
```{r}
m_p <- df_og %>% filter(Species=="P bur", Treatment %in% c("P bur_v", "CP_v", "PC_v"))
m_c <- df_og %>% filter(Species=="Colp", Treatment %in% c("Colp_v", "CP_v", "PC_v"))

m_p$Treatment <- as.character(m_p$Treatment)
m_c$Treatment <- as.character(m_c$Treatment)

m_pana<- summarySE(m_p, measurevar="Cells", groupvars=c("Treatment","Light_Level")) #create analysis df 
m_pana$Treatment = factor(m_pana$Treatment, labels = c("Colp-first", "Control", "P bur-first"))
m_pana= mutate(m_pana, Treatment=fct_relevel(Treatment,"Control","P bur-first", "Colp-first"))
m_pana$Light_Level = factor(m_pana$Light_Level, labels = c("0μE", "100μE", "200μE", "50μE"))
m_pana= mutate(m_pana, Light_Level=fct_relevel(Light_Level,"0μE","50μE", "100μE", "200μE"))

names(m_c)<- c("Treatment", "Species", "Light_Level", "Replicate", "Experimental_Day", "Cells", "Growth_Rate")
m_cana<- summarySE(m_c, measurevar="Cells", groupvars=c("Light_Level", "Treatment")) #create analysis df 

m_cana$Treatment = factor(m_cana$Treatment, labels = c("Control", "Colp-first", "P bur-first"))
m_cana= mutate(m_cana, Treatment=fct_relevel(Treatment,"Control","P bur-first", "Colp-first"))
m_cana$Light_Level = factor(m_cana$Light_Level, labels = c("0μE", "100μE", "200μE", "50μE"))
m_cana= mutate(m_cana, Light_Level=fct_relevel(Light_Level,"0μE","50μE", "100μE", "200μE"))

m_pgana<- summarySE(m_p, measurevar="Growth_Rate", groupvars=c("Light_Level", "Treatment")) #create analysis df 
m_pgana$Light_Level = factor(m_pgana$Light_Level, labels = c("0μE", "100μE", "200μE", "50μE"))
m_pgana= mutate(m_pgana, Light_Level=fct_relevel(Light_Level,"0μE","50μE", "100μE", "200μE"))
m_pgana$Treatment = factor(m_pgana$Treatment, labels = c("Colp-first", "Control", "P bur-first"))
m_pgana= mutate(m_pgana, Treatment=fct_relevel(Treatment,"Control", "P bur-first", "Colp-first"))
# change treatment labels from number to treatment description:
# m_pgana$Treatment = factor(m_pgana$Treatment, labels = c("P bursaria single", "Competition", "Colpdium first", "Paramecium first"))

m_cgana<- summarySE(m_c, measurevar="Growth_Rate", groupvars=c("Light_Level", "Treatment")) #create analysis df 

m_cgana$Light_Level = factor(m_cgana$Light_Level, labels = c("0μE", "100μE", "200μE", "50μE"))
m_cgana= mutate(m_cgana, Light_Level=fct_relevel(Light_Level,"0μE","50μE", "100μE", "200μE"))
m_cgana$Treatment = factor(m_cgana$Treatment, labels = c("Control", "Colp-first", "P bur-first"))
m_cgana= mutate(m_cgana, Treatment=fct_relevel(Treatment,"Control","P bur-first", "Colp-first"))
# change treatment labels from number to treatment description:
#m_cana$Treatment = factor(m_cana$Treatment, labels = c("Colpidium single", "Competition", "Colpdium first", "Paramecium first"))
#m_cana = mutate(m_pana, Treatment=fct_relevel(Treatment,"Colpidium single","Competition", "Colpidium first", "Paramecium first"))

```
Graph A)
```{r}
labels.mp <- c("a", "a", "a", "a", "a", "b", "b", "a", "a", "a", "a", "a")

p.m_p <- ggplot(m_pana, aes(x = `Treatment`, y = `Cells`, fill = `Light_Level`)) +
  geom_col(position = "dodge")+   
    scale_fill_manual(values=pcolors, labels = c('0μE','50μE','100μE','200μE'))+
  geom_errorbar(aes(ymin=`Cells`-se, ymax=`Cells`+se),
                  width=.2,                   
                  position=position_dodge(.9),
                show.legend=FALSE) + 
  theme_light()+
  scale_y_continuous(limits = c(0, 7500), expand=c(0,0))+
  scale_x_discrete(expand=c(0,0))+
  theme(legend.text=element_text(size=12, face='italic'),
        legend.key.size = unit(0.7, 'lines'),
        legend.background=element_rect(colour=NA, fill=NA),
        legend.position = c(0.9, 0.7),
        legend.title= element_blank(),
        legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
        legend.margin=margin(c(-5,1,1,1)),
        axis.line = element_blank(),
        axis.line.y.left = element_line(color="grey"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        plot.tag.position = c(0.01,1),
        plot.tag = element_text(size=15),
        plot.title = element_text(size=12, margin = margin(title), hjust = (0.5)),
        axis.ticks.x = element_blank(),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 8, angle = 90,hjust=.5),
        axis.title = element_blank())+
    labs(title = "P. bursaria",
       tag="A") +
    geom_text(aes(label = labels.mp, y = `Cells`+se), position = position_dodge(0.9), vjust = -.3, size=4)
```

Graph B)
```{r}

labels.mc <- c("a", "abc", "cd", "a", "a", "ab", "a", "a", "d", "ab", "cd", "bcd")
p.m_c <- ggplot(m_cana, aes(x = `Treatment`, y = `Cells`, fill = `Light_Level`)) +
  geom_col(position = "dodge")+  
   scale_fill_manual(values=ccolors)+
  geom_errorbar(aes(ymin=`Cells`-se, ymax=`Cells`+se),
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9)) + #add axis and title names
  theme_light()+
  scale_y_continuous(limits = c(0, 8500), expand=c(0,0))+
  scale_x_discrete(expand=c(0,0))+
  theme(legend.text=element_text(size=12, face='italic'),
        legend.key.size = unit(0.7, 'lines'),
        legend.background=element_rect(colour=NA, fill=NA),
        legend.position = c(0.15, 0.7),
        legend.title= element_blank(),
        legend.box.background=element_rect(linetype = 'solid', colour = 'grey'),
        legend.margin=margin(c(-5,1,1,1)),
        axis.line = element_blank(),
        axis.line.y.left= element_line(color="gray"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        plot.tag.position = c(0.01,1),
        plot.tag = element_text(size=15),
        plot.title = element_text(size=12, margin = margin(title), hjust = (0.5)),
        axis.ticks.x = element_blank(),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 8, angle = 90, hjust=.5),
        axis.title = element_blank())+
    labs(title = "Colpidium",
       tag="B")+
      geom_text(aes(label = labels.mc, y = `Cells`+se), position = position_dodge(0.9), vjust = -.3, size=4)
```

Graph C)
```{r}

labels.gp1 <- c(NA,NA,NA,"de", "b", "bd", "de", "b", "bd", "e", "bd", "b") 
labels.gp2 <- c("d", "a", "a", NA, NA, NA, NA,NA,NA,NA,NA,NA)
p.m_pg <- ggplot(m_pgana, aes(x = `Treatment`, y = `Growth_Rate`, fill = `Light_Level`)) +
  geom_col(position = "dodge")+
   scale_fill_manual(values=pcolors)+
  geom_errorbar(aes(ymin=`Growth_Rate`-se, ymax=`Growth_Rate`+se),
                  width=.2,                    # Width of the error bars
                  position=position_dodge(.9)) + #add axis and title names
   theme_light()+
  scale_y_continuous(limits = c(-.25, .2), expand=c(0,0), breaks=c(-.15,0,.15))+
  scale_x_discrete(expand=c(0,0))+
  theme(legend.position = "none",
        axis.line = element_blank(),
        axis.line.y.left= element_line(color="gray"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        plot.tag.position = c(0.01,1),
        plot.tag = element_text(size=15),
        plot.title = element_text(size=12, margin = margin(title), hjust = (0.5)),
        axis.ticks.x = element_blank(),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 8, angle=90, hjust=0.5),
        axis.title = element_blank())+
    labs(title = "P. bursaria",
       tag="C")+
    geom_text(aes(label = labels.gp1, y = `Growth_Rate`+se), position = position_dodge(0.9), vjust = -.3, size=4)+
    geom_text(aes(label = labels.gp2, y = 0), position = position_dodge(0.9), vjust = -.3, size=4)
```

Graph D)
```{r}
labels.gc <- c("ab", "ab", "ab", "a", "ab", "a", "b", "ab", "a", "a", "ab", "ab")
p.m_cg <- ggplot(m_cgana, aes(x = `Treatment`, y = `Growth_Rate`, fill = `Light_Level`)) +
  geom_col(position = "dodge")+  
   scale_fill_manual(values=ccolors)+
  geom_errorbar(aes(ymin=`Growth_Rate`-se, ymax=`Growth_Rate`+se),
                  width=.2,           
                  position=position_dodge(.9)) + 
   theme_light()+
  scale_y_continuous(limits = c(0,1), expand=c(0,0), breaks=c(.3, .6, .9))+
  scale_x_discrete(expand=c(0,0))+
  theme(legend.position = "none",
        axis.line = element_blank(),        
        axis.line.y.left= element_line(color="gray"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        plot.tag.position = c(0.01,1),
        plot.tag = element_text(size=15),
        plot.title = element_text(size=12, margin = margin(title), hjust = (0.5)),
        axis.ticks.x = element_blank(),
        axis.text.x = element_text(size = 10),
        axis.text.y = element_text(size = 8, angle = 90, hjust=0.5),
        axis.title = element_blank())+
    labs(title = "Colpidium",
       tag="D")+   
    geom_text(aes(label = labels.gc, y = `Growth_Rate`+se), position = position_dodge(0.9), vjust = -.3, size=4)

p.m<- ggdraw() +
  draw_plot(p.m_p, 0, 0, .5, .8) +
  draw_plot(p.m_c, .5, 0, .5, .8) 

p.gr<- ggdraw() +
  draw_plot(p.m_pg, 0, 0, .5, .8) +
  draw_plot(p.m_cg, .5, 0, .5, .8) 


annotate_figure(p.m,
                left = text_grob("Maximum population (cells/mL)", size=10, rot = 90))
annotate_figure(p.gr,
                left = text_grob("Growth rate (cells per day)", size=10, rot = 90))
```

#Tukey test without comp 4/16/2020
```{r}
# Compute the analysis of variance
m_p2 <- m_p %>% filter(`Treatment` %in% c("P bur", "CP", "PC"))
m_c2 <- m_c %>% filter(`Treatment` %in% c("Colp", "CP", "PC"))
res.aov_m_p2 <- aov(`Cells` ~ `Light_Level`*Treatment, data = m_p2)
res.aov_m_c2 <- aov(`Cells` ~ `Light_Level`*Treatment, data = m_c2)

res.aov_m_pg2 <- aov(`Growth_Rate` ~ `Light_Level`*Treatment, data = m_p2)
res.aov_m_cg2 <- aov(`Growth_Rate` ~ `Light_Level`*Treatment, data = m_c2)

# Summary of the analysis
summary(res.aov_m_p2)
summary(res.aov_m_c2)
summary(res.aov_m_pg2)
summary(res.aov_m_cg2)

TukeyHSD(res.aov_m_p2)
TukeyHSD(res.aov_m_c2)
TukeyHSD(res.aov_m_pg2)
TukeyHSD(res.aov_m_cg2)
```


